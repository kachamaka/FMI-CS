<!DOCTYPE html>

<head>
	<meta charset="utf-8">
	<title>Пример 1904: Актуализиране на данни</title>

	<script src="suica.min.js"></script>

	<style>
		body {position: absolute; }
		
		.panel {
			position: absolute;
			left: 10px;
			top: 10px;
			width: 100px;
			border: solid 1px black;
			padding: 0 0.25em 0.5em 0.25em;
			text-align: center;
			background-color: DarkSeaGreen;
		}
		
		.panel div {
			margin: 0.25em 0;
		}
		
		input { text-align: center; }
	</style>
	
	<script>
		function main()
		{
			p = new Suica();
			orthographic(-1000,1000);
			lookAt([0,0,100],[0,0,0],[0,1,0]);
			background([0.8,1,0.9]);
			
			line([0,0,0],[1,0,0]);
			line([0,0,0],[0,1,0]);
			
			p.gl.canvas.addEventListener('mousedown',mouseDown,false);
			
			elemX = document.getElementById('x');
			elemY = document.getElementById('y');
			elemR = document.getElementById('r');
			elemRandom = document.getElementById('random');
			elemCreate = document.getElementById('create');
			
			blinker = circle([0,0,0],0).custom({color:[0,0,0],mode:Suica.LINE});
			p.nextFrame = animate;
		}
		
		var obj = null;
		
		var z = -100;
		function create()
		{
			var x = Number(elemX.value);
			var y = Number(elemY.value);
			var r = Number(elemR.value);

			if (obj)
			{
				obj.center = [x,y,0];
				obj.radius = r;

				blinker.center = [x,y,0];
				blinker.radius = r;
			}
			else
			{
				circle([x,y,z++],r).custom({
					color:[random(0,1),random(0,1),random(0,1)],
					interactive:true
					});
			
				elemX.value = '';
				elemY.value = '';
				elemR.value = '';
			}
		}
		
		function randomData()
		{
			elemX.value = Math.round(random(-300,300));
			elemY.value = Math.round(random(-150,150));
			elemR.value = Math.round(random(10,80));
		}
		
		function mouseDown(event)
		{
			obj = p.objectAtPoint(event.clientX,event.clientY);
			if (obj)
			{
				blinker.visible = true;
				blinker.center = obj.center;
				blinker.radius = obj.radius;

				elemX.value = obj.center[0];
				elemY.value = obj.center[1];
				elemR.value = obj.radius;

				elemRandom.disabled = true;
				elemCreate.innerHTML = 'Промени';
			}
			else
			{
				blinker.visible = false;

				elemX.value = '';
				elemY.value = '';
				elemR.value = '';

				elemRandom.disabled = false;
				elemCreate.innerHTML = 'Създай';
			}
		}
		
		function animate()
		{
			if (obj)
			{
				blinker.visible = (2*Suica.time)%1>0.5;
			}
		}
		
	</script>	
</head>

<body onload="main()">
	<noscript>
		Искаме JavaScript, но няма!
	</noscript>
	
	<div class="panel">
		<h3>Окръжност</h3>
		<button id="random" onclick="randomData()">Случайни данни</button>
		<br>
		<div>X = <input type="text" id="x" value="" size="2"></div>
		<div>Y = <input type="text" id="y" value="" size="2"></div>
		<div>R = <input type="text" id="r" value="" size="2"></div>
		<br>
		<button id="create" onclick="create()">Създай</button>
	</div>
	<canvas width="740" height="350" style="border: solid 1px Black;">
		Искаме canvas, но няма!
	</canvas>
	
</body>
