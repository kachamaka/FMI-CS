<!DOCTYPE html>

<head>
	<meta charset="utf-8">
	<title>Пример 1712: Интерактивна 3D сцена</title>

	<script src="suica.min.js"></script>

	<script>
		function main()
		{
			p = new Suica();
			lookAt([200,0,0],[0,0,0],[0,0,1]);
			
			p.gl.canvas.addEventListener('mousedown',mouseDown,false);
			p.gl.canvas.addEventListener('mousemove',mouseMove,false);
			p.gl.canvas.addEventListener('contextmenu',function(e){e.preventDefault();},false);

			for (var i=0; i<100; i++)
			{
				var center = [random(-150,150),random(-150,150),random(-150,150)];
				var n = Math.round(random(3,8));
				prism(center,10,20,n).custom({
					spin: random(0,2*Math.PI),
					focus: [random(-1,1),random(-1,1),random(-1,1)],
					color: [random(0,1),random(0,1),random(0,1)]
				});
			}
		}

		lookA = 0;
		lookB = 0;
		lookD = 200;
		
		function mouseDown(event)
		{
			x = event.clientX;
			y = event.clientY;
		}
		
		cos = Math.cos;
		sin = Math.sin;
		
		function mouseMove(event)
		{
			if (event.buttons==1)
			{
				lookA -= (event.clientX-x)/200;
				lookB += (event.clientY-y)/200;
				if (lookB>+1.5) lookB=+1.5;
				if (lookB<-1.5) lookB=-1.5;
			}

			if (event.buttons==2)
			{
				lookD *= Math.pow(1.01,event.clientY-y);
				if (lookD<10) lookD=10;
				if (lookD>1000) lookD=1000;
			}

			lookAt ( [lookD*cos(lookA)*cos(lookB),
					  lookD*sin(lookA)*cos(lookB),
					  lookD*sin(lookB)], [0,0,0], [0,0,1]);
			x = event.clientX;
			y = event.clientY;
		}
	</script>	
</head>

<body onload="main()">
	<noscript>
		Искаме JavaScript, но няма!
	</noscript>
	
	<canvas width="740" height="350" style="border: solid 1px Black;">
		Искаме canvas, но няма!
	</canvas>
</body>
