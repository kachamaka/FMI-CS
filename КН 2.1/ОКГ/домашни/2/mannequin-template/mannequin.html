<!DOCTYPE html>

<html>
	<head>
		<script src="three.min.js"></script>
		<script src="mannequin.js"></script>
		<style>
			body {color: black; text-shadow: 0 0 4px gray; font-family: Calibri;}
			h1   {position: fixed; z-index: 10; top: 0; left: 0; text-align: center; width: 100%;}
			div  {position: fixed; z-index: 10; bottom: 1em; left: 1em; font-size: 1.5em; font-style: italic;}
		</style>
	</head>

	<body>
	
		<!-- Сложете реално заглавие -->
		<h1>Аматьорски боксьори</h1>  
		
		<!-- Сложете описание на сцената (опитайте с рима) -->
		<div>
            Избрах аз боксьори да сложа,<br>
            без много мисъл да му вложа,<br>
            дали добре ще се получи... <br>
            важното е да продължава да се учи.
		</div>

		<button id="start" style="position: fixed; font-size: 1.25em; width: 6em; top: 30%; left: calc(50% - 3em);" onclick="start()">Старт</button>


		<audio id="music" src="ken's theme.mp3"></audio>

		<script>

            function start() {   
                document.getElementById('music').play();
                
                createScene();

                
                
                
                A = {"version":6,"data":[3.2,[0,-40.8,0],[-2.3,-49.9,-3.2],[0,0,-6],[6,0,13.5],[32.8],[-6,-6,-10.5],[-4.8,-40.8,6],[22.9],[6,3,-15.4],[7,-0.6,-2.6],[146.1],[-11.7,0,0],[119.9,99.9],[-17.2,-1.6,24.2],[126.3],[0.4,0,0],[120,99.9]]};
                
                
                man1 = new Male();
                man1.position.set(-12, 0, -4);
                man1.rotation.y = Math.PI/3;
                man1.posture = A;
                man2 = new Male();
                man2.position.set(12, 0, 4);
                man2.rotation.y = Math.PI+Math.PI/3;
                man2.posture = A;
                
                A1 = {"version":6,"data":[1.7,[0,-40.8,0],[-0.9,-27.7,-2.3],[-1.1,-9.9,-6.1],[6,0,4.3],[42.7],[-6,-6,-30.5],[-4.8,-40.8,12.3],[48.3],[6,3,-29.6],[7,-0.6,-2.6],[150],[-11.7,0,0],[119.9,99.9],[-17.2,-1.6,24.2],[150],[0.4,0,0],[120,99.9]]};

                A2 = {"version":6,"data":[2,[0,-25.7,0],[-5.5,-45.1,-7.6],[-0.5,-6.7,-4],[6,0,19.6],[47.9],[-6,-6,-23.5],[-4.8,-40.8,22.9],[46.6],[6,3,-20.4],[7,-0.6,-11.2],[150],[-11.7,0,0],[119.9,99.9],[-17.2,-1.6,4.3],[148.2],[0.4,0,0],[120,99.9]]};

                A3 = {"version":6,"data":[0.1,[0,-40.8,0.9],[-0.3,-30.5,-3.9],[0,0,-4.8],[6,0,32],[59.4],[-6,-6,-28.2],[-4.8,-40.8,30.3],[64.3],[6,3,-26.6],[7,-0.6,-8.5],[150],[-11.7,0,0],[119.9,99.9],[-4.8,16.6,8.4],[150],[0.4,0,0],[120,99.9]]};

                A4 = {"version":6,"data":[2.8,[0,-40.8,0],[-0.4,-11.5,-2],[0,0,-6],[6,0,5.4],[32.4],[-6,-6,-23.5],[-4.8,-40.8,20.4],[38.8],[6,3,-13.9],[10.9,-0.8,-2.6],[150],[-11.7,0,0],[119.9,99.9],[-9.2,2,24.2],[150],[0.4,0,0],[120,99.9]]};

                B = {"version":6,"data":[3.5,[0,-27.2,0],[-0.6,-18.8,-2.1],[0,0,-6],[6,0,13.5],[32.8],[-6,-6,-10.5],[-4.8,-40.8,6],[22.9],[6,3,-15.4],[7,-0.6,-2.6],[146.1],[-11.7,0,0],[120,100],[-89.9,1.5,66.2],[12],[7.5,18.3,-2.8],[119.9,99.9]]};
                
                C = {"version":6,"data":[3.6,[0,-50.2,0],[0.3,-62.4,1.9],[0,0,-6],[13.8,-29.6,10.5],[33.4],[-0.5,22.7,-7.2],[-4.8,-40.8,6],[22.9],[6,3,-15.4],[92.1,0.5,59.9],[11],[-11.7,0,0],[120,100],[-15.9,-6.1,19.6],[141.1],[7.4,16.4,-2.7],[119.9,99.9]]};
                
                D = {"version":6,"data":[1.8,[-1.3,-50.2,-0.1],[24.9,-1.1,-2.8],[-1.8,-17,-6.3],[12.7,-29.7,11.8],[45.5],[-6.8,-6,-23.3],[-4.8,-40.8,23.3],[51.9],[6,3,-17.7],[3.8,-13.7,7.1],[149.9],[-11.7,0,0],[120,100],[-14.3,-20.6,-12.8],[123.9],[87.9,87.4,-81.3],[119.9,99.9]]};
                
                E = {"version":6,"data":[4.6,[-1.3,-50.2,-0.1],[10.5,44.6,-2.8],[-3,-27,-6.8],[12.7,-29.7,-7.6],[0],[-7.1,-4.5,33.1],[-4.8,-40.8,0.2],[1],[6,3,42.2],[3.8,-13.7,7.1],[149.9],[-11.7,0,0],[120,100],[-9.9,-54.7,130.9],[43],[87.9,87.4,-81.3],[119.9,99.9]]};

                M = {"version":6,"data":[3.3,[-1.3,-50.2,-0.1],[10.5,44.6,-2.8],[-3,-27,-6.8],[12.7,-29.7,-2.9],[15.3],[-7.1,-4.5,-12.7],[-4.8,-40.8,13.3],[35.6],[6,3,-13.1],[3.8,-13.7,7.1],[149.9],[-11.7,0,0],[120,100],[-9.9,-54.7,18.9],[142.1],[87.9,87.4,-81.3],[119.9,99.9]]};
                
                N = {"version":6,"data":[4,[-1.3,-50.2,-0.1],[10.5,44.6,-4.5],[-3,-27,-6.8],[12.7,-29.7,3.3],[9.6],[-7.1,-4.5,-3.6],[-4.8,-40.8,8.8],[14.5],[6,3,2.9],[3.8,-13.7,7.1],[132],[-11.7,0,0],[120,100],[-9.9,-54.7,9.7],[129.7],[87.9,87.4,-81.3],[119.9,99.9]]};
                
                P = {"version":6,"data":[2.9,[-1.3,-50.2,-0.1],[4.2,29.6,-3.3],[-3,-27,-6.8],[12.7,-29.7,21.2],[35.5],[-7.1,-4.5,-15.4],[-4.8,-40.8,17],[18.1],[6,3,3.5],[3.8,-13.7,7.1],[150],[-11.7,0,0],[120,100],[-9.9,-54.7,9.7],[150],[87.9,87.4,-81.3],[119.9,99.9]]};
                
                
                F = {"version":6,"data":[3.4,[3.4,-22.8,-0.3],[6.3,-23.6,9.1],[0,0,-6],[6,0,13.5],[32.8],[-6,-6,-10.5],[-4.8,-40.8,6],[22.9],[6,3,-15.4],[7,-0.6,-2.6],[146.1],[-11.7,0,0],[119.9,99.9],[-17.2,-1.6,24.2],[126.3],[0.4,0,0],[120,99.9]]};
                
                G = {"version":6,"data":[3.4,[0,-69,0],[-12.9,-50.2,-1.9],[0,0,-6],[6,0,13.5],[32.8],[-6,-6,-10.5],[-4.8,-40.8,6],[22.9],[6,3,-15.4],[7,-0.6,11.2],[137.5],[-11.7,0,0],[119.9,99.9],[-20.3,16.7,9.8],[147.5],[0.4,0,0],[120,99.9]]};
                
                H = {"version":6,"data":[2.1,[0,-40.8,0],[-2.3,-49.9,-21.2],[0,0,-11.8],[6,0,28.8],[50.5],[-6,-6,-10.5],[-4.8,-40.8,22.2],[44.9],[6,3,-15.4],[7.5,10.7,-16.4],[146.1],[-11.7,0,0],[119.9,99.9],[-17.2,-1.6,14.8],[126.3],[0.4,0,0],[120,99.9]]};
                
                I = {"version":6,"data":[2.1,[0,-63.6,0],[-1.4,-1,21],[0,0,4],[6,0,44.8],[12.7],[-6,-6,-10.5],[-11.3,-22.3,18.8],[0.4],[6,3,-15.4],[-35.6,10.3,136.1],[0],[-11.7,0,0],[119.9,99.9],[25.5,-12.5,111.1],[10.8],[0.4,0,0],[120,99.9]]};
                
                J = {"version":6,"data":[5.9,[0,-63.6,55.1],[-1.4,-1,21],[0,0,4],[6,0,44.8],[12.7],[-6,-6,-10.5],[-11.3,-22.2,39.7],[0.4],[6,3,-15.4],[-2.6,18,87.2],[0],[-11.7,0,0],[119.9,99.9],[-21.6,-27.4,72.1],[10.8],[0.4,0,0],[120,99.9]]};
                
                K = {"version":6,"data":[6.7,[0,-63.6,67.5],[-1.4,-1,20.3],[0,0,-4.9],[6,0,38.1],[7.9],[-6,-6,-10.5],[-11.3,-22.2,29.6],[6.6],[6,3,-15.4],[15.8,50.4,62],[26],[-11.7,0,0],[119.9,99.9],[-38.8,-56.7,51.6],[25.5],[0.4,0,0],[120,99.9]]};
                
                L = {"version":6,"data":[-24.6,[0,-63.6,68.9],[0.3,-5.5,26.8],[0,0,0.4],[6,0,20.9],[1],[-2.5,-30.5,8.4],[-11.3,-22.2,21.1],[0],[-9.7,28.4,22.6],[163.7,75.4,-68.1],[39.6],[-11.7,0,0],[119.9,99.9],[-109.5,-83.1,-6.2],[24.4],[0.4,0,0],[120,99.9]]};
                
                a = 0;
                b = 0;
                c = 0;
                d = 0;
                e = 0;
                f = 0;
                g = 0;
                h = 0;
                i = 0;
                
                step = 0.04;
                standBy = true;
                time = false;
                fallen = false;
            }
            
            function man1StandBy(){
                let pose1, pose2, pose3;
                if(fallen == true){
                    pose1 = M;
                    pose2 = N;
                    pose3 = P;
                }else{
                    pose1 = A1;
                    pose2 = A;
                    pose3 = A2;
                }
                if(standBy == false) return;
                man1.posture = Mannequin.blend(pose1, pose2, f);
                if(f<1){
                    man1.position.x -= 0.1;
                    f+=step;
                    return;
                }
                man1.posture = Mannequin.blend(pose2, pose3, g);
                if(g<1){
                    man1.position.x -= 0.1;
                    g+=step;
                    return;
                }
                man1.posture = Mannequin.blend(pose3, pose2, g-1);
                if(g<2){
                    man1.position.x += 0.1;
                    g+=step;
                    return;
                }
                
                man1.posture = Mannequin.blend(pose2, pose1, f-1);
                if(f<2){
                    man1.position.x += 0.1;
                    f+=step;
                    return;
                }
                
                g = 0;
                f = 0;
            }    

            function man2StandBy(){
                if(fallen == true) return;
                let pose1 = A3, pose2 = A, pose3 = A4;

                man2.posture = Mannequin.blend(pose1, pose2, h);
                if(h<1){
                    man2.position.x -= 0.1;
                    h+=step;
                    return;
                }
                man2.posture = Mannequin.blend(pose2, pose3, i);
                if(i<1){
                    man2.position.x -= 0.1;
                    i+=step;
                    return;
                }
                man2.posture = Mannequin.blend(pose3, pose2, i-1);
                if(i<2){
                    man2.position.x += 0.1;
                    i+=step;
                    return;
                }
                
                man2.posture = Mannequin.blend(pose2, pose1, h-1);
                if(h<2){
                    man2.position.x += 0.1;
                    h+=step;
                    return;
                }
                
                h = 0;
                i = 0;
            }  

            function animate(t) {
                scene.rotation.y = t / 170;
                if(t >= 970 && time == false){
                    standBy = false;
                }

                man1StandBy();
                man2StandBy();
                if(standBy == true) return;
                fallen = true;

                man1.posture = Mannequin.blend(A, B, a);
                man2.posture = Mannequin.blend(A, F, a);
                if(a < 1){
                    a += step;
                    return;
                }
                man1.posture = Mannequin.blend(B, A, a-1);
                man2.posture = Mannequin.blend(F, A, a-1);
                if(a < 2){
                    a += step;
                    return;
                }

                man1.posture = Mannequin.blend(A, C, b);
                man2.posture = Mannequin.blend(A, G, b);
                if(b < 1){
                    b += step;
                    return;
                }
                man1.posture = Mannequin.blend(C, A, b-1);
                man2.posture = Mannequin.blend(G, A, b-1);
                if(b < 2){
                    b += step;
                    return;
                }
                
                man1.posture = Mannequin.blend(A, D, c);
                man2.posture = Mannequin.blend(A, H, c);
                if(c < 1){
                    man1.position.x += 0.2;
                    c += step;
                    return;
                }
                man1.posture = Mannequin.blend(D, E, c-1);
                man2.posture = Mannequin.blend(H, I, c-1);
                if(c < 2){
                    man1.position.x += 0.2;
                    man1.position.y += 0.1;

                    man2.position.y += 0.2;
                    man2.position.x += 0.4;
                    c += step;
                    return;
                }
                
                man1.posture = Mannequin.blend(E, M, d);
                man2.posture = Mannequin.blend(I, J, d);
                if(d<1){
                    man1.position.y -= 0.1;
                    man1.position.x -= 0.2;


                    man2.position.y += 0.2;
                    man2.position.x += 0.4;
                    d+=step;
                    return;
                }
                
                standBy = true;
                man1StandBy();

                man2.posture = Mannequin.blend(J, K, e);
                if(e<1){
                    man2.position.y -= 0.2;
                    man2.position.x += 0.4;
                    e+=step;
                    return;
                }

                man2.posture = Mannequin.blend(K, L, e-1);
                if(e<2){
                    man2.position.y -= 0.2;
                    man2.position.x += 0.4;
                    e+=step;
                    return;
                }

			}

		</script>
	</body>
</html>